---
title: "M8_Draft_SF"
author: "Sarah Figueroa"
date: "11/3/2021"
output: html_document
bibliography: BIOL3140.bib
---

## Introduction

The force that a vertebrae muscle can produce is governed by both length and velocity. This study will focus on the force-length relationship. 

In order to produce muscle contractions, cross bridges in the actin-myosin overlap region of a sarcomere produce the force necessary for these actin and myosin filaments to slide past each other [@Rassier1999]. So, the overall force that a skeletal muscle can produce is related to the number of cross bridges present. Because cross bridges are only present in the actin-myosin overlap region, the maximum isometric force that can be produced is in turn related to the amount of actin-myosin overlap. 

Another factor that affects the maximum isometric force produced by a muscle is the arrangement of the lever system of the muscle. In this experiment we will study the human upper limb. It has been shown that the the force measured at the hand as the muscle produces isometric force at various lengths reflects the force-length relationship at the fiber level relatively accurately, regardless of effective inlever changes during movement [@Rassier1999]. So, this factor can be reasonably ignored in this study. 

It has been experimentally shown that with increasing lengths, isometric force increases, reaches a plateau, and then decreases [@Rassier1999]. This study will attempt to reproduce this result and further test whether eccentric fatigue has an effect on the force length relationship. In previous studies, researchers showed that eccentric exercises produced changes in the muscle that shifted the angle-torque relationship to longer muscle lengths without a significant decrease in maximum force [@Yeung2008]. 


## Methods
In order to assess the affect of eccentric fatigue of elbow flexor muscles, the measurements of isometric force over the range of motion of the forearm produced by maximum voluntary contractions (MVCs) were taken with DAQ and analyzed. 
An Arduino-based force-data aquisition system was set up and a ganiometer was constructed to carry out the experiment. 
The isometric force data from MVCs were collected over 12 arm angles before and after fatiguing the forearm muscles. Isometric force-angle curves were produced to analyze at what angle maximum isometric force (Fmax) occurs (θmax). The values were normalized by dividing the maximum force across all angles for each experiment by Fmax. The angle of non-fatigued and eccentrically fatigued forearm flexors at their maximum isometric force were compared in order to determine the shift of θmax between the two conditions. 

## Results
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse) #always
library(nlme) #ditto
library(MuMIn)
library(knitr) #for knitting options
require(broom)
library(features)
```

```{r}
dat.f <- list.files(pattern = "control|fatigue") #find the files
print(dat.f)
dat.l <- list() #make an empty list
mass.l <- list() #make list for masses
for(i in dat.f){
  met.dat<- unlist(strsplit(i,"_"))
  team <- met.dat[1]
  subject <- met.dat[2]
  angle <- met.dat[3]
  cond <- as.double(gsub(".csv","",met.dat[4])) #dropping .csv with gsub
  dat.l[[i]]<- read_csv(i)%>%
    mutate(team=team,subject=subject,angle=angle, cond=cond)
}
dat <- do.call(rbind,dat.l) #combine the list into table
```

```{r}
#find maximum force for each recording
#idk what the label is for force?
dat.max <- dat%>%
  group_by(cond, subject, angle)%>%
  summarize(maxf=max(f))

#find maximum force over all angles for each person and condition
dat.max2 <- dat.max%>%
  group_by(cond, subject) %>%
  summarize(maxf2=max(maxf))

#normalize data to where max force is 1
dat.normF%>%
  left_join(dat.max2)%>%
  mutate(normF=maxf/maxf2)
  

#find the angle of maximum force for each subject and type
#this is just copy&paste - might have to change variables but this is general idea
poly.m2 <- lm(normF~poly(ang,2)) #second order
poly.m3 <- lm(normF~poly(ang,3)) #third order
poly.m4 <- lm(normF~poly(ang,4)) #fourth order

AICc(poly.m2,poly.m3,poly.m4)

#use the best fitting model to find max value
x.pred <- seq(45,157.5,length.out = 1000) #define 1000 angles from our range

# use this but replace poly.m4 with whatever is best fit: normF.pred <- predict(poly.m4,newdata = data.frame(angle=x.pred)) #predict the force using 1000 angles

#qplot(angle,normF)+geom_point(aes(x=x.pred,y=normF.pred),col="red")+geom_point(aes(x=x.pred[which.max(normF.pred)],y=normF.pred[which.max(normF.pred)]),size=5,col="blue")
```

## Discussion

## Author Contributions

## References